# Identity Context (ì¸ì¦/ì¸ê°€ ì»¨í…ìŠ¤íŠ¸)

> ì‚¬ìš©ì ì¸ì¦, ì¸ê°€, ê¶Œí•œ ê´€ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸

---

## ğŸ“– ê°œìš”

Identity ContextëŠ” ì‚¬ìš©ìì˜ ì‹ë³„, ì¸ì¦, ê¶Œí•œ ê´€ë¦¬ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤.
ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ë“¤ì´ ì‚¬ìš©ì ì •ë³´ë¥¼ í•„ìš”ë¡œ í•  ë•Œ ì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•´ ì ‘ê·¼í•©ë‹ˆë‹¤.

---

## ğŸ¯ ì±…ì„ (Responsibilities)

1. **ì‚¬ìš©ì ë“±ë¡ (Registration)**
   - ì‹ ê·œ ì‚¬ìš©ì íšŒì›ê°€ì…
   - ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
   - ì´ˆê¸° ì—­í•  í• ë‹¹ (USER)

2. **ì¸ì¦ (Authentication)**
   - ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ
   - JWT í† í° ë°œê¸‰
   - ë¹„ë°€ë²ˆí˜¸ ê²€ì¦

3. **ê¶Œí•œ ê´€ë¦¬ (Authorization)**
   - ì—­í• (Role) ê´€ë¦¬
   - ê¶Œí•œ í™•ì¸
   - ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬

4. **ì‚¬ìš©ì ê´€ë¦¬ (User Management)**
   - ì‚¬ìš©ì ì •ë³´ ìˆ˜ì •
   - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
   - ê³„ì • í™œì„±í™”/ë¹„í™œì„±í™”

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
identity/
â”œâ”€â”€ domain/                    # ë„ë©”ì¸ ê³„ì¸µ
â”‚   â”œâ”€â”€ model/                 # ë„ë©”ì¸ ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ User.java         # ì• ê·¸ë¦¬ê²Œì´íŠ¸ ë£¨íŠ¸
â”‚   â”‚   â”œâ”€â”€ UserId.java       # ê°’ ê°ì²´ (ì‹ë³„ì)
â”‚   â”‚   â”œâ”€â”€ Email.java        # ê°’ ê°ì²´
â”‚   â”‚   â”œâ”€â”€ Password.java     # ê°’ ê°ì²´
â”‚   â”‚   â”œâ”€â”€ UserName.java     # ê°’ ê°ì²´
â”‚   â”‚   â”œâ”€â”€ Role.java         # Enum
â”‚   â”‚   â””â”€â”€ UserStatus.java   # Enum
â”‚   â”œâ”€â”€ service/               # ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”‚   â””â”€â”€ PasswordEncryptionService.java
â”‚   â”œâ”€â”€ repository/            # Repository ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ UserRepository.java
â”‚   â””â”€â”€ event/                 # ë„ë©”ì¸ ì´ë²¤íŠ¸
â”‚       â”œâ”€â”€ UserRegisteredEvent.java
â”‚       â”œâ”€â”€ UserLoggedInEvent.java
â”‚       â”œâ”€â”€ PasswordChangedEvent.java
â”‚       â””â”€â”€ UserDeactivatedEvent.java
â”‚
â”œâ”€â”€ application/               # ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ
â”‚   â”œâ”€â”€ AuthService.java      # ì¸ì¦ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ UserManagementService.java
â”‚   â”œâ”€â”€ dto/                   # DTO (Command, Result)
â”‚   â”‚   â”œâ”€â”€ SignupCommand.java
â”‚   â”‚   â”œâ”€â”€ LoginCommand.java
â”‚   â”‚   â””â”€â”€ LoginResult.java
â”‚   â””â”€â”€ event/                 # ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
â”‚       â””â”€â”€ UserEventHandler.java
â”‚
â”œâ”€â”€ infrastructure/            # ì¸í”„ë¼ ê³„ì¸µ
â”‚   â”œâ”€â”€ persistence/
â”‚   â”‚   â”œâ”€â”€ UserJpaEntity.java
â”‚   â”‚   â”œâ”€â”€ UserJpaRepository.java
â”‚   â”‚   â”œâ”€â”€ UserRepositoryImpl.java
â”‚   â”‚   â””â”€â”€ UserMapper.java
â”‚   â””â”€â”€ security/
â”‚       â””â”€â”€ BCryptPasswordEncryption.java
â”‚
â””â”€â”€ presentation/              # í‘œí˜„ ê³„ì¸µ
    â””â”€â”€ AuthController.java
```

---

## ğŸ¨ ë„ë©”ì¸ ëª¨ë¸

### ì• ê·¸ë¦¬ê²Œì´íŠ¸: User

```
User (Aggregate Root)
  â”œâ”€â”€ UserId (ì‹ë³„ì)
  â”œâ”€â”€ Email (ê°’ ê°ì²´)
  â”œâ”€â”€ Password (ê°’ ê°ì²´)
  â”œâ”€â”€ UserName (ê°’ ê°ì²´)
  â”œâ”€â”€ Role (Enum)
  â””â”€â”€ UserStatus (Enum)
```

#### ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
1. ì‹ ê·œ ì‚¬ìš©ìëŠ” USER ì—­í• ë¡œ ì‹œì‘
2. ì´ë©”ì¼ì€ ê³ ìœ í•´ì•¼ í•¨
3. ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ
4. ë¹„í™œì„±í™”ëœ ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ ë¶ˆê°€
5. ê´€ë¦¬ìëŠ” ì‚­ì œ ë¶ˆê°€

---

## ğŸ“¦ í•µì‹¬ ê°’ ê°ì²´

### Email
- ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
- ì†Œë¬¸ìë¡œ ì •ê·œí™”
- ë„ë©”ì¸ ì¶”ì¶œ ê¸°ëŠ¥
- ë§ˆìŠ¤í‚¹ ê¸°ëŠ¥ (`u***@example.com`)

### Password
- ë¹„ë°€ë²ˆí˜¸ ê·œì¹™ ê²€ì¦ (8ì ì´ìƒ)
- ì•”í˜¸í™” ìº¡ìŠí™”
- ë§¤ì¹­ ë©”ì„œë“œ ì œê³µ
- ì›ë³¸ ë¹„ë°€ë²ˆí˜¸ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ

### UserName
- ì´ë¦„ ê¸¸ì´ ê²€ì¦ (1-100ì)
- íŠ¹ìˆ˜ë¬¸ì ê²€ì¦
- ì•ë’¤ ê³µë°± ì œê±°

---

## ğŸ”„ ë„ë©”ì¸ ì´ë²¤íŠ¸

### UserRegisteredEvent
```java
// ë°œìƒ ì‹œì : ì‹ ê·œ ì‚¬ìš©ì ë“±ë¡ ì™„ë£Œ
// ì²˜ë¦¬: í™˜ì˜ ì´ë©”ì¼ ë°œì†¡, í†µê³„ ì—…ë°ì´íŠ¸
```

### UserLoggedInEvent
```java
// ë°œìƒ ì‹œì : ë¡œê·¸ì¸ ì„±ê³µ
// ì²˜ë¦¬: ë¡œê·¸ì¸ ì´ë ¥ ì €ì¥, ë³´ì•ˆ ì•Œë¦¼
```

### PasswordChangedEvent
```java
// ë°œìƒ ì‹œì : ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
// ì²˜ë¦¬: ë³´ì•ˆ ì•Œë¦¼ ì´ë©”ì¼
```

### UserDeactivatedEvent
```java
// ë°œìƒ ì‹œì : ê³„ì • ë¹„í™œì„±í™”
// ì²˜ë¦¬: ì„¸ì…˜ ë¬´íš¨í™”, ê´€ë ¨ ë°ì´í„° ì •ë¦¬
```

---

## ğŸ’¼ ì£¼ìš” ìœ ìŠ¤ì¼€ì´ìŠ¤

### 1. íšŒì›ê°€ì…
```java
// Application Service
authService.signup(new SignupCommand(
    "user@example.com",
    "password123",
    "í™ê¸¸ë™"
));

// ë„ë©”ì¸ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬:
// 1. Email, Password ê°’ ê°ì²´ ìƒì„± (ê²€ì¦ ìë™)
// 2. User.register() ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ í˜¸ì¶œ
// 3. UserRegisteredEvent ë°œí–‰
// 4. ì €ì¥ ë° ì´ë²¤íŠ¸ ë°œí–‰
```

### 2. ë¡œê·¸ì¸
```java
// Application Service
LoginResult result = authService.login(new LoginCommand(
    "user@example.com",
    "password123"
));

// ë„ë©”ì¸ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬:
// 1. ì‚¬ìš©ì ì¡°íšŒ
// 2. user.authenticate() ë©”ì„œë“œ í˜¸ì¶œ
// 3. JWT í† í° ìƒì„±
// 4. UserLoggedInEvent ë°œí–‰
```

### 3. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
```java
// Application Service
authService.changePassword(
    userId,
    new ChangePasswordCommand(
        "oldPassword",
        "newPassword123"
    )
);

// ë„ë©”ì¸ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬:
// 1. í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
// 2. user.changePassword() ë©”ì„œë“œ í˜¸ì¶œ
// 3. PasswordChangedEvent ë°œí–‰
```

---

## ğŸ”Œ ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ì™€ì˜ ê´€ê³„

### Talent Context
- UserIdë¥¼ ì°¸ì¡°í•˜ì—¬ ì´ë ¥ì„œ ì†Œìœ ì ì‹ë³„
- ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ (ì´ë¦„, ì´ë©”ì¼)

### Communication Context
- UserIdë¥¼ ì°¸ì¡°í•˜ì—¬ ì±„íŒ… ì°¸ì—¬ì ì‹ë³„
- ì‚¬ìš©ì í‘œì‹œ ì •ë³´ ì œê³µ

---

## ğŸ“ êµ¬í˜„ ìƒíƒœ

| í•­ëª© | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| ë„ë©”ì¸ ëª¨ë¸ | ğŸŸ¡ ì¼ë¶€ ì™„ë£Œ | UserIdë§Œ êµ¬í˜„ |
| ê°’ ê°ì²´ | âšªï¸ ë¯¸ì™„ | Email, Password í•„ìš” |
| ì• ê·¸ë¦¬ê²Œì´íŠ¸ | âšªï¸ ë¯¸ì™„ | User ì¬ì„¤ê³„ í•„ìš” |
| ë„ë©”ì¸ ì´ë²¤íŠ¸ | âšªï¸ ë¯¸ì™„ | ì´ë²¤íŠ¸ ì •ì˜ í•„ìš” |
| Application Service | âšªï¸ ë¯¸ì™„ | ë¦¬íŒ©í† ë§ í•„ìš” |
| Repository | âšªï¸ ë¯¸ì™„ | ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ í•„ìš” |

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (Phase 2)

1. [ ] Email ê°’ ê°ì²´ êµ¬í˜„
2. [ ] Password ê°’ ê°ì²´ êµ¬í˜„
3. [ ] UserName ê°’ ê°ì²´ êµ¬í˜„
4. [ ] User ì• ê·¸ë¦¬ê²Œì´íŠ¸ ì¬ì„¤ê³„
5. [ ] ë„ë©”ì¸ ì´ë²¤íŠ¸ ì •ì˜
6. [ ] Repository ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬
7. [ ] AuthService ë¦¬íŒ©í† ë§
8. [ ] í…ŒìŠ¤íŠ¸ ì‘ì„±

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [ë¦¬íŒ©í† ë§ ê³„íš.txt](../../../../docs-for-ddd%20êµ¬ì¡°ë¡œ%20ë¦¬íŒ©í† ë§/ë¦¬íŒ©í† ë§%20ê³„íš.txt)
- [ì˜ˆì‹œ ì½”ë“œ: User Aggregate](../../../../docs-for-ddd%20êµ¬ì¡°ë¡œ%20ë¦¬íŒ©í† ë§/ì˜ˆì‹œ%20ì½”ë“œ/2_User_AggregateRoot.java)
- [ì˜ˆì‹œ ì½”ë“œ: Email Value Object](../../../../docs-for-ddd%20êµ¬ì¡°ë¡œ%20ë¦¬íŒ©í† ë§/ì˜ˆì‹œ%20ì½”ë“œ/1_Email_ValueObject.java)

---

**ì‘ì„±ì¼**: 2024-02-06  
**ë²„ì „**: 1.0  
**ë‹´ë‹¹**: Identity Team